{"version":3,"sources":["components/index/ItemComponent.js","components/index/ItemsComponent.js","containers/IndexContainer.js","actions/index/ItemsAction.js","pages/IndexPage.js","dispatchers/IndexDispatcher.js","../node_modules/timeago.js/lib/constant.js","api/HackerNewsApi.js","../node_modules/timeago.js/lib/helper.js","../node_modules/timeago.js/lib/locales.js","../node_modules/timeago.js/lib/timer.js","components/common/Header.js","../node_modules/timeago.js/lib/index.js","actionTypes/ItemsType.js","models/Item.js","../node_modules/timeago.js/lib/TimeAgo.js","stores/ItemsStore.js"],"names":["ItemComponent","react_default","a","createElement","className","href","this","props","item","getUrl","title","score","dist","to","URL","name","userId","by","getTimeAgo","itemId","id","descendants","React","Component","ItemsComponent","itemComponents","items","map","ItemComponent_ItemComponent","key","page","IndexContainer","Header","ItemsComponent_ItemsComponent","state","stores","itemsStore","prevState","getState","indexContainer","Container","create","withProps","ItemsAction","dispatcher","Object","classCallCheck","dispatch","type","itemsType","SYNC","IndexPage","length","NotFoundPage","indexDispatcher","Dispatcher","newItemsStore","sync","params","containers_IndexContainer","NProgress","start","HackerNewsApi","getTopStoryItems","done","defineProperty","exports","value","IndexMapEn","split","IndexMapZH","ATTR_DATA_TID","SEC_ARRAY","ATTR_TIMEAGO","ATTR_DATETIME","hackerNewsApi","_Users_Takashi_GitHub_async_react_router_examples_flux_utils_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","displayNumber","Firebase","apps","initializeApp","databaseURL","api","database","ref","cache","LRU","max","maxAge","getTopStoryItemIds","ids","offset","limit","Promise","all","slice","_ref","_Users_Takashi_GitHub_async_react_router_examples_flux_utils_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_Takashi_GitHub_async_react_router_examples_flux_utils_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee","wrap","_context","prev","next","_this","findItem","abrupt","sent","stop","_x","apply","arguments","has","get","child","once","snapshot","val","set","concat","_ref2","_callee5","_context5","_this2","_x4","comments","_ref3","_callee6","comment","_context6","getComments","kids","_x5","setTidAttr","getDateAttr","getAttr","nextInterval","diffSec","formatDiff","toDate","toInt","undefined","_constant","__webpack_require__","_locales","f","parseInt","input","Date","isNaN","test","trim","replace","diff","locale","defaultLocale","Locales","i","agoin","total_sec","Math","abs","date","nowDate","rst","d","ceil","node","getAttribute","attr","setAttribute","register","en","number","index","unit","zh_CN","func","run","cancel","Timers","_helper","clear","tid","clearTimeout","delay","setTimeout","react__WEBPACK_IMPORTED_MODULE_5___default","async_react_router__WEBPACK_IMPORTED_MODULE_6__","_TimeAgo","_timer","factory","TimeAgo","default","module","__webpack_exports__","Symbol","Item","url","timeago","format","time","Immutable","Record","_createClass","defineProperties","target","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","prototype","instance","TypeError","_classCallCheck","innerHTML","doRender","min","nodes","len","ItemsStore","List","action","withMutations","newState","itemAttributes","push","ReduceStore"],"mappings":"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","file":"static/js/2.76abb7be.chunk.js","sourcesContent":["import React from \"react\";\nimport { Link, URL } from \"async-react-router\";\n\nexport default class ItemComponent extends React.Component {\n  render() {\n    return (\n      <div className=\"news-item\">\n        <h3 className=\"title\">\n          <a href={this.props.item.getUrl()}>{this.props.item.title}</a>\n        </h3>\n        <div>\n          <ul className=\"list-inline\">\n            <li className=\"score\">{this.props.item.score} points</li>\n            <li className=\"by\">\n              by{\" \"}\n              <Link to={URL.name(\"UserPage\", { userId: this.props.item.by })}>\n                {this.props.item.by}\n              </Link>\n            </li>\n            <li className=\"time\">{this.props.item.getTimeAgo()}</li>\n            <li className=\"comments-link\">\n              <Link to={URL.name(\"ItemPage\", { itemId: this.props.item.id })}>\n                {this.props.item.descendants} comments\n              </Link>\n            </li>\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ItemComponent from \"./ItemComponent\";\nimport { Link, URL } from \"async-react-router\";\n\nexport default class ItemsComponent extends React.Component {\n  render() {\n    const itemComponents = this.props.items.map((item) => (\n      <ItemComponent key={item.id} item={item} />\n    ));\n    return (\n      <div className=\"container\">\n        {itemComponents}\n        <h3>\n          <Link to={URL.name(\"NewsPage\", { page: 2 })}>more</Link>\n        </h3>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { Container } from \"flux/utils\";\nimport Header from \"../components/common/Header\";\nimport ItemsComponent from \"../components/index/ItemsComponent\";\n\nclass IndexContainer extends React.Component {\n  static getStores(props) {\n    return [props.stores.itemsStore];\n  }\n\n  static calculateState(prevState, props) {\n    return {\n      items: props.stores.itemsStore.getState()\n    };\n  }\n\n  render() {\n    return (\n      <div>\n        <Header />\n        <ItemsComponent items={this.state.items} />\n      </div>\n    );\n  }\n}\n\nconst indexContainer = Container.create(IndexContainer, {\n  withProps: true\n});\nexport default indexContainer;\n","import { itemsType } from \"../../actionTypes/ItemsType\";\n\nclass ItemsAction {\n  constructor(dispatcher) {\n    this.dispatcher = dispatcher;\n  }\n\n  sync(items) {\n    this.dispatcher.dispatch({\n      type: itemsType.SYNC,\n      items: items\n    });\n  }\n}\n\nexport function newItemsAction(dispatcher) {\n  return new ItemsAction(dispatcher);\n}\n","import NProgress from \"nprogress\";\nimport React from \"react\";\nimport IndexContainer from \"../containers/IndexContainer\";\nimport HackerNewsApi from \"../api/HackerNewsApi\";\nimport NotFoundPage from \"./NotFoundPage\";\nimport { newIndexDispatcher } from \"../dispatchers/IndexDispatcher\";\nimport { newItemsAction } from \"../actions/index/ItemsAction\";\nimport { newItemsStore } from \"../stores/ItemsStore\";\n\nexport default class IndexPage extends React.Component {\n  static initialPropsWillGet() {\n    NProgress.start();\n  }\n\n  static async getInitialProps() {\n    return {\n      items: await HackerNewsApi.getTopStoryItems()\n    };\n  }\n\n  static initialPropsDidGet() {\n    NProgress.done();\n  }\n\n  render() {\n    if (!this.props.items.length) return <NotFoundPage />;\n\n    const indexDispatcher = newIndexDispatcher();\n    const itemsStore = newItemsStore(indexDispatcher);\n    const itemsAction = newItemsAction(indexDispatcher);\n    itemsAction.sync(this.props.items);\n\n    const params = {\n      stores: {\n        itemsStore\n      }\n    };\n\n    return <IndexContainer {...params} />;\n  }\n}\n","import { Dispatcher } from \"flux\";\n\nexport function newIndexDispatcher() {\n  return new Dispatcher();\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n\nvar IndexMapEn = exports.IndexMapEn = 'second_minute_hour_day_week_month_year'.split('_');\nvar IndexMapZH = exports.IndexMapZH = '秒_分钟_小时_天_周_月_年'.split('_');\nvar ATTR_DATA_TID = exports.ATTR_DATA_TID = 'data-tid';\nvar SEC_ARRAY = exports.SEC_ARRAY = [60, 60, 24, 7, 365 / 7 / 12, 12];\nvar ATTR_TIMEAGO = exports.ATTR_TIMEAGO = 'data-timeago';\nvar ATTR_DATETIME = exports.ATTR_DATETIME = 'datetime';","import Firebase from \"firebase/app\";\nimport \"firebase/database\";\nimport LRU from \"lru-cache\";\n\nclass HackerNewsApi {\n  constructor() {\n    this.displayNumber = 20;\n\n    if (!Firebase.apps.length) {\n      Firebase.initializeApp({\n        databaseURL: \"https://hacker-news.firebaseio.com\"\n      });\n    }\n    this.api = Firebase.database().ref(\"/v0\");\n    this.cache = LRU({\n      max: 500,\n      maxAge: 1000 * 60 * 60\n    });\n  }\n\n  async getTopStoryItems(page = 1) {\n    const ids = await this.getTopStoryItemIds();\n    const offset = this.displayNumber * (page - 1);\n    const limit = offset + this.displayNumber;\n    return await Promise.all(\n      ids.slice(offset, limit).map(async (id) => await this.findItem(id))\n    );\n  }\n\n  async getTopStoryItemIds() {\n    if (this.cache.has(\"topstories\")) return this.cache.get(\"topstories\");\n    const snapshot = await this.api.child(\"/topstories\").once(\"value\");\n    const value = snapshot.val();\n    this.cache.set(\"topstories\", value);\n    return value;\n  }\n\n  async findItem(id) {\n    if (this.cache.has(`item/${id}`)) return this.cache.get(`item/${id}`);\n    const snapshot = await this.api.child(`/item/${id}`).once(\"value\");\n    const value = snapshot.val();\n    this.cache.set(`item/${id}`, value);\n    return value;\n  }\n\n  async getComments(ids) {\n    if (!ids) {\n      return [];\n    }\n\n    const comments = await Promise.all(\n      ids.map(async (id) => await this.findItem(id))\n    );\n    return await Promise.all(\n      comments.map(async (comment) => {\n        comment.comments = await this.getComments(comment.kids);\n        return comment;\n      })\n    );\n  }\n\n  async findUser(id) {\n    if (this.cache.has(`/user/${id}`)) return this.cache.get(`/user/${id}`);\n    const snapshot = await this.api.child(`/user/${id}`).once(\"value\");\n    const value = snapshot.val();\n    this.cache.set(`/user/${id}`, value);\n    return value;\n  }\n}\n\nconst hackerNewsApi = new HackerNewsApi();\n\nexport default hackerNewsApi;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setTidAttr = exports.getDateAttr = exports.getAttr = exports.nextInterval = exports.diffSec = exports.formatDiff = exports.toDate = exports.toInt = undefined;\n\nvar _constant = require('./constant');\n\nvar _locales = require('./locales');\n/**\n * change f into int, remove decimal. Just for code compression\n * @param f\n * @returns {number}\n */\n\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n\n\nvar toInt = exports.toInt = function toInt(f) {\n  return parseInt(f);\n};\n/**\n * format Date / string / timestamp to Date instance.\n * @param input\n * @returns {*}\n */\n\n\nvar toDate = exports.toDate = function toDate(input) {\n  if (input instanceof Date) return input;\n  if (!isNaN(input) || /^\\d+$/.test(input)) return new Date(toInt(input));\n  input = (input || '').trim().replace(/\\.\\d+/, '') // remove milliseconds\n  .replace(/-/, '/').replace(/-/, '/').replace(/(\\d)T(\\d)/, '$1 $2').replace(/Z/, ' UTC') // 2017-2-5T3:57:52Z -> 2017-2-5 3:57:52UTC\n  .replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/, ' $1$2'); // -04:00 -> -0400\n\n  return new Date(input);\n};\n/**\n * format the diff second to *** time ago, with setting locale\n * @param diff\n * @param locale\n * @param defaultLocale\n * @returns {string | void | *}\n */\n\n\nvar formatDiff = exports.formatDiff = function formatDiff(diff, locale, defaultLocale) {\n  // if locale is not exist, use defaultLocale.\n  // if defaultLocale is not exist, use build-in `en`.\n  // be sure of no error when locale is not exist.\n  locale = _locales.Locales[locale] ? locale : _locales.Locales[defaultLocale] ? defaultLocale : 'en';\n  var i = 0,\n      agoin = diff < 0 ? 1 : 0,\n      // timein or timeago\n  total_sec = diff = Math.abs(diff);\n\n  for (; diff >= _constant.SEC_ARRAY[i] && i < _constant.SEC_ARRAY.length; i++) {\n    diff /= _constant.SEC_ARRAY[i];\n  }\n\n  diff = toInt(diff);\n  i *= 2;\n  if (diff > (i === 0 ? 9 : 1)) i += 1;\n  return _locales.Locales[locale](diff, i, total_sec)[agoin].replace('%s', diff);\n};\n/**\n * calculate the diff second between date to be formatted an now date.\n * @param date\n * @param nowDate\n * @returns {number}\n */\n\n\nvar diffSec = exports.diffSec = function diffSec(date, nowDate) {\n  nowDate = nowDate ? toDate(nowDate) : new Date();\n  return (nowDate - toDate(date)) / 1000;\n};\n/**\n * nextInterval: calculate the next interval time.\n * - diff: the diff sec between now and date to be formatted.\n *\n * What's the meaning?\n * diff = 61 then return 59\n * diff = 3601 (an hour + 1 second), then return 3599\n * make the interval with high performance.\n **/\n\n\nvar nextInterval = exports.nextInterval = function nextInterval(diff) {\n  var rst = 1,\n      i = 0,\n      d = Math.abs(diff);\n\n  for (; diff >= _constant.SEC_ARRAY[i] && i < _constant.SEC_ARRAY.length; i++) {\n    diff /= _constant.SEC_ARRAY[i];\n    rst *= _constant.SEC_ARRAY[i];\n  }\n\n  d = d % rst;\n  d = d ? rst - d : rst;\n  return Math.ceil(d);\n};\n/**\n * get the node attribute, native DOM and jquery supported.\n * @param node\n * @param name\n * @returns {*}\n */\n\n\nvar getAttr = exports.getAttr = function getAttr(node, name) {\n  if (node.getAttribute) return node.getAttribute(name); // native dom\n\n  if (node.attr) return node.attr(name); // jquery dom\n};\n/**\n * get the datetime attribute, `data-timeagp` / `datetime` are supported.\n * @param node\n * @returns {*}\n */\n\n\nvar getDateAttr = exports.getDateAttr = function getDateAttr(node) {\n  return getAttr(node, _constant.ATTR_TIMEAGO) || getAttr(node, _constant.ATTR_DATETIME);\n};\n/**\n * set the node attribute, native DOM and jquery supported.\n * @param node\n * @param val\n * @returns {*}\n */\n\n\nvar setTidAttr = exports.setTidAttr = function setTidAttr(node, val) {\n  if (node.setAttribute) return node.setAttribute(_constant.ATTR_DATA_TID, val);\n  if (node.attr) return node.attr(_constant.ATTR_DATA_TID, val);\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.register = exports.Locales = undefined;\n\nvar _constant = require('./constant');\n\nvar zh_CN = function zh_CN(number, index) {\n  if (index === 0) return ['刚刚', '片刻后'];\n\n  var unit = _constant.IndexMapZH[parseInt(index / 2)];\n\n  return [number + ' ' + unit + \"\\u524D\", number + ' ' + unit + \"\\u540E\"];\n};\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n\n\nvar en = function en(number, index) {\n  if (index === 0) return ['just now', 'right now'];\n\n  var unit = _constant.IndexMapEn[parseInt(index / 2)];\n\n  if (number > 1) unit += 's';\n  return [number + ' ' + unit + ' ago', 'in ' + number + ' ' + unit];\n};\n/**\n * 所有的语言\n * @type {{en: function(*, *), zh_CN: function(*, *)}}\n */\n\n\nvar Locales = exports.Locales = {\n  en: en,\n  zh_CN: zh_CN\n};\n/**\n * 注册语言\n * @param locale\n * @param func\n */\n\nvar register = exports.register = function register(locale, func) {\n  Locales[locale] = func;\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.run = exports.cancel = exports.Timers = undefined;\n\nvar _helper = require('./helper');\n\nvar _constant = require('./constant'); // 所有的定时器\n\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n\n\nvar Timers = exports.Timers = [];\n\nvar clear = function clear(tid) {\n  if (tid) {\n    clearTimeout(tid);\n    delete Timers[tid];\n  }\n};\n/**\n * 取消定时器\n * @param node\n */\n\n\nvar cancel = exports.cancel = function cancel(node) {\n  if (node) clear((0, _helper.getAttr)(node, _constant.ATTR_DATA_TID)); // get the timer of DOM node(native / jq).\n  else for (var tid in Timers) {\n      clear(tid);\n    }\n};\n/**\n * 开启一个 timer\n * @param func\n * @param delay\n */\n\n\nvar run = exports.run = function run(func, delay) {\n  var tid = setTimeout(function () {\n    // 从 Timer 中删除\n    clear(tid); // 执行目标方法\n\n    func();\n  }, delay); // there is no need to save node in object. Just save the key\n\n  Timers[tid] = 0;\n  return tid;\n};","import React from \"react\";\nimport { Link, URL } from \"async-react-router\";\n\nexport default class Header extends React.Component {\n  render() {\n    return (\n      <header className=\"navbar navbar-default\">\n        <nav className=\"container\">\n          <div className=\"d-flex justify-content-between hidden-lg-up\">\n            <Link to={URL.name(\"IndexPage\")} className=\"navbar-brand\">\n              Flux Utils Example - Hacker News\n            </Link>\n          </div>\n        </nav>\n      </header>\n    );\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _TimeAgo = require('./TimeAgo');\n\nvar _locales = require('./locales');\n\nvar _timer = require('./timer'); // 入口函数\n\n\nvar factory = function factory(nowDate, locale) {\n  return new _TimeAgo.TimeAgo(nowDate, locale);\n};\n/**\n * 注册语言\n */\n\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n\n\nfactory.register = _locales.register;\n/**\n * 终止定时器\n */\n\nfactory.cancel = _timer.cancel;\nexports.default = factory;\nmodule.exports = exports['default'];","export const itemsType = {\n  SYNC: Symbol(\"items/sync\")\n};\n","import Immutable from \"immutable\";\nimport { URL } from \"async-react-router\";\nimport timeago from \"timeago.js\";\n\nconst ItemRecord = Immutable.Record({\n  by: \"\",\n  descendants: 0,\n  id: null,\n  score: 0,\n  time: null,\n  title: \"\",\n  type: \"\",\n  url: \"\",\n  kids: null\n});\n\nexport default class Item extends ItemRecord {\n  getUrl() {\n    if (this.url) {\n      return this.url;\n    }\n\n    return URL.name(\"ItemPage\", { itemId: this.id });\n  }\n\n  getTimeAgo() {\n    return timeago().format(new Date(this.time * 1000));\n  }\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TimeAgo = undefined;\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n\n\nvar _helper = require('./helper');\n\nvar _timer = require('./timer');\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar TimeAgo = exports.TimeAgo = function () {\n  function TimeAgo(nowDate, defaultLocale) {\n    _classCallCheck(this, TimeAgo);\n\n    this.nowDate = nowDate;\n    this.defaultLocale = defaultLocale || 'en';\n  }\n\n  _createClass(TimeAgo, [{\n    key: 'setLocale',\n    value: function setLocale(locale) {\n      this.defaultLocale = locale;\n    }\n    /**\n     * render 定期器渲染\n     * @param node\n     * @param date\n     * @param locale\n     */\n\n  }, {\n    key: 'doRender',\n    value: function doRender(node, date, locale) {\n      var _this = this;\n\n      var diff = (0, _helper.diffSec)(date, this.nowDate); // render\n\n      node.innerHTML = (0, _helper.formatDiff)(diff, locale, this.defaultLocale); // waiting %s seconds, do the next render\n\n      var tid = (0, _timer.run)(function () {\n        _this.doRender(node, date, locale);\n      }, Math.min((0, _helper.nextInterval)(diff) * 1000, 0x7FFFFFFF)); // set attribute date-tid\n\n      (0, _helper.setTidAttr)(node, tid);\n    }\n    /**\n     * render: render the DOM real-time.\n     * - nodes: which nodes will be rendered.\n     * - locale: the locale name used to format date.\n     *\n     * How to use it?\n     * var timeago = require('timeago.js')();\n     * // 1. javascript selector\n     * timeago.render(document.querySelectorAll('.need_to_be_rendered'));\n     * // 2. use jQuery selector\n     * timeago.render($('.need_to_be_rendered'), 'pl');\n     *\n     * Notice: please be sure the dom has attribute `datetime`.\n     */\n\n  }, {\n    key: 'render',\n    value: function render(nodes, locale) {\n      // by .length\n      if (nodes.length === undefined) nodes = [nodes];\n      var node = void 0;\n\n      for (var i = 0, len = nodes.length; i < len; i++) {\n        node = nodes[i]; // clear node's timer\n\n        (0, _timer.cancel)(node);\n        this.doRender(node, (0, _helper.getDateAttr)(node), locale); // render item\n      }\n    }\n    /**\n     * format: format the date to *** time ago, with setting or default locale\n     * - date: the date / string / timestamp to be formatted\n     * - locale: the formatted string's locale name, e.g. en / zh_CN\n     *\n     * How to use it?\n     * var timeago = require('timeago.js')();\n     * timeago.format(new Date(), 'pl'); // Date instance\n     * timeago.format('2016-09-10', 'fr'); // formated date string\n     * timeago.format(1473473400269); // timestamp with ms\n     */\n\n  }, {\n    key: 'format',\n    value: function format(date, locale) {\n      return (0, _helper.formatDiff)((0, _helper.diffSec)(date, this.nowDate), locale, this.defaultLocale);\n    }\n  }]);\n\n  return TimeAgo;\n}();","import Immutable from \"immutable\";\nimport { ReduceStore } from \"flux/utils\";\nimport { itemsType } from \"../actionTypes/ItemsType\";\nimport Item from \"../models/Item\";\n\nclass ItemsStore extends ReduceStore {\n  getInitialState() {\n    return Immutable.List();\n  }\n\n  reduce(state, action) {\n    switch (action.type) {\n      case itemsType.SYNC:\n        const newState = Immutable.List();\n        return newState.withMutations((newState) => {\n          action.items.map((itemAttributes) =>\n            newState.push(new Item(itemAttributes))\n          );\n        });\n      default:\n        return state;\n    }\n  }\n}\n\nexport function newItemsStore(dispatcher) {\n  return new ItemsStore(dispatcher);\n}\n"],"sourceRoot":""}