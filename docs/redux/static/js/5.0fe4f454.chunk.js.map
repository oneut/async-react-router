{"version":3,"sources":["api/HackerNewsApi.js","components/common/Header.js","models/User.js","actionTypes/UserActionType.js","reducers/user/index.js","reducers/user/user.js","components/user/UserComponent.js","containers/UserContainer.js","actions/UserAction.js","pages/UserPage.js"],"names":["hackerNewsApi","HackerNewsApi","Object","_Users_Takashi_GitHub_async_react_router_examples_redux_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","this","displayNumber","Firebase","apps","length","initializeApp","databaseURL","api","database","ref","cache","LRU","max","maxAge","page","getTopStoryItemIds","ids","offset","limit","Promise","all","slice","map","_ref","_Users_Takashi_GitHub_async_react_router_examples_redux_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_Takashi_GitHub_async_react_router_examples_redux_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee","id","wrap","_context","prev","next","_this","findItem","abrupt","sent","stop","_x","apply","arguments","has","get","child","once","snapshot","value","val","set","concat","_ref2","_callee5","_context5","_this2","_x4","comments","_ref3","_callee6","comment","_context6","getComments","kids","_x5","Header","react__WEBPACK_IMPORTED_MODULE_5___default","createElement","className","async_react_router__WEBPACK_IMPORTED_MODULE_6__","to","URL","name","React","Component","User","Immutable","Record","karma","created","userActionType","NEW_INSTANCE","Symbol","rootReducer","combineReducers","user","state","undefined","action","type","attributes","UserComponent","react_default","props","UserContainer","UserComponent_UserComponent","connect","userAction","newInstance","UserPage","NotFoundPage","store","createStore","userRootReducer","actions","bindActionCreators","dispatch","es","containers_UserContainer","params","NProgress","start","findUser","userId","done"],"mappings":"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","file":"static/js/5.0fe4f454.chunk.js","sourcesContent":["import Firebase from \"firebase/app\";\nimport \"firebase/database\";\nimport LRU from \"lru-cache\";\n\nclass HackerNewsApi {\n  constructor() {\n    this.displayNumber = 20;\n\n    if (!Firebase.apps.length) {\n      Firebase.initializeApp({\n        databaseURL: \"https://hacker-news.firebaseio.com\"\n      });\n    }\n    this.api = Firebase.database().ref(\"/v0\");\n    this.cache = LRU({\n      max: 500,\n      maxAge: 1000 * 60 * 60\n    });\n  }\n\n  async getTopStoryItems(page = 1) {\n    const ids = await this.getTopStoryItemIds();\n    const offset = this.displayNumber * (page - 1);\n    const limit = offset + this.displayNumber;\n    return await Promise.all(\n      ids.slice(offset, limit).map(async (id) => await this.findItem(id))\n    );\n  }\n\n  async getTopStoryItemIds() {\n    if (this.cache.has(\"topstories\")) return this.cache.get(\"topstories\");\n    const snapshot = await this.api.child(\"/topstories\").once(\"value\");\n    const value = snapshot.val();\n    this.cache.set(\"topstories\", value);\n    return value;\n  }\n\n  async findItem(id) {\n    if (this.cache.has(`item/${id}`)) return this.cache.get(`item/${id}`);\n    const snapshot = await this.api.child(`/item/${id}`).once(\"value\");\n    const value = snapshot.val();\n    this.cache.set(`item/${id}`, value);\n    return value;\n  }\n\n  async getComments(ids) {\n    if (!ids) {\n      return [];\n    }\n\n    const comments = await Promise.all(\n      ids.map(async (id) => await this.findItem(id))\n    );\n    return await Promise.all(\n      comments.map(async (comment) => {\n        comment.comments = await this.getComments(comment.kids);\n        return comment;\n      })\n    );\n  }\n\n  async findUser(id) {\n    if (this.cache.has(`/user/${id}`)) return this.cache.get(`/user/${id}`);\n    const snapshot = await this.api.child(`/user/${id}`).once(\"value\");\n    const value = snapshot.val();\n    this.cache.set(`/user/${id}`, value);\n    return value;\n  }\n}\n\nconst hackerNewsApi = new HackerNewsApi();\n\nexport default hackerNewsApi;\n","import React from \"react\";\nimport { URL, Link } from \"async-react-router\";\n\nexport default class Header extends React.Component {\n  render() {\n    return (\n      <header className=\"navbar navbar-default\">\n        <nav className=\"container\">\n          <div className=\"d-flex justify-content-between hidden-lg-up\">\n            <Link to={URL.name(\"IndexPage\")} className=\"navbar-brand\">\n              Redux Example - Hacker News\n            </Link>\n          </div>\n        </nav>\n      </header>\n    );\n  }\n}\n","import Immutable from \"immutable\";\n\nconst UserRecord = Immutable.Record({\n  id: \"\",\n  karma: 0,\n  created: null\n});\n\nexport default class User extends UserRecord {}\n","export const userActionType = {\n  NEW_INSTANCE: Symbol(\"user/newInstance\")\n};\n","import { combineReducers } from \"redux\";\nimport user from \"./user\";\n\nconst rootReducer = combineReducers({\n  user\n});\n\nexport default rootReducer;\n","import User from \"../../models/User\";\nimport { userActionType } from \"../../actionTypes/UserActionType\";\n\nexport default function user(state = null, action) {\n  switch (action.type) {\n    case userActionType.NEW_INSTANCE:\n      return new User(action.attributes);\n    default:\n      return state;\n  }\n}\n","import React from \"react\";\n\nexport default class UserComponent extends React.Component {\n  render() {\n    return (\n      <div className=\"container\">\n        <h3>User: {this.props.user.id}</h3>\n        <p>created: {this.props.user.created}</p>\n        <p>karma: {this.props.user.karma}</p>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport Header from \"../components/common/Header\";\nimport UserComponent from \"../components/user/UserComponent\";\n\nclass UserContainer extends React.Component {\n  render() {\n    if (!this.props.user) {\n      return null;\n    }\n\n    return (\n      <div>\n        <Header />\n        <UserComponent user={this.props.user} />\n      </div>\n    );\n  }\n}\n\nexport default connect((state) => ({\n  user: state.user\n}))(UserContainer);\n","import { userActionType } from \"../actionTypes/UserActionType\";\n\nexport const userAction = {\n  newInstance: (attributes) => {\n    return {\n      type: userActionType.NEW_INSTANCE,\n      attributes: attributes\n    };\n  }\n};\n","import NProgress from \"nprogress\";\nimport React from \"react\";\nimport { createStore } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport userRootReducer from \"../reducers/user\";\nimport UserContainer from \"../containers/UserContainer\";\nimport HackerNewsApi from \"../api/HackerNewsApi\";\nimport NotFoundPage from \"./NotFoundPage\";\nimport { bindActionCreators } from \"redux\";\nimport { userAction } from \"../actions/UserAction\";\n\nexport default class UserPage extends React.Component {\n  static initialPropsWillGet() {\n    NProgress.start();\n  }\n\n  static async getInitialProps(attributes) {\n    return {\n      user: await HackerNewsApi.findUser(attributes.params.userId)\n    };\n  }\n\n  static initialPropsDidGet() {\n    NProgress.done();\n  }\n\n  render() {\n    if (!this.props.user) return <NotFoundPage />;\n\n    const ProviderWrapper = () => {\n      const store = createStore(userRootReducer);\n\n      const actions = {\n        user: bindActionCreators(userAction, store.dispatch)\n      };\n      actions.user.newInstance(this.props.user);\n\n      return (\n        <Provider store={store}>\n          <UserContainer params={this.props.params} actions={actions} />\n        </Provider>\n      );\n    };\n\n    return <ProviderWrapper />;\n  }\n}\n"],"sourceRoot":""}